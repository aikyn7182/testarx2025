<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ақпараттық технологиялар тесті - 149 сұрақ</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f9ff;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            margin-top: 0;
            font-size: 2.5rem;
        }
        
        .test-container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }
        
        .question {
            margin-bottom: 30px;
            padding: 20px;
            border-left: 5px solid #4b6cb7;
            background-color: #f8fbff;
            border-radius: 0 8px 8px 0;
        }
        
        .question-number {
            font-weight: bold;
            color: #4b6cb7;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .question-text {
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .variants {
            margin-left: 15px;
        }
        
        .variant {
            margin-bottom: 10px;
            padding: 12px 15px;
            background-color: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .variant:hover {
            background-color: #f0f5ff;
            border-color: #a3c1ff;
        }
        
        .variant.selected {
            background-color: #e3eeff;
            border-color: #4b6cb7;
        }
        
        .variant.correct {
            background-color: #e7f7e7 !important;
            border-color: #2ecc71 !important;
            color: #155724;
        }
        
        .variant.correct::after {
            content: " ✓ ДҰРЫС";
            color: #27ae60;
            font-weight: bold;
            position: absolute;
            right: 15px;
        }
        
        .variant.incorrect {
            background-color: #ffeaea !important;
            border-color: #e74c3c !important;
            color: #721c24;
        }
        
        .variant.incorrect::after {
            content: " ✗ ҚАТЕ";
            color: #e74c3c;
            font-weight: bold;
            position: absolute;
            right: 15px;
        }
        
        .variant.disabled {
            cursor: not-allowed;
            opacity: 0.9;
        }
        
        .variant.disabled:hover {
            background-color: white;
            border-color: #e0e0e0;
        }
        
        .controls {
            text-align: center;
            margin-top: 30px;
            position: sticky;
            bottom: 20px;
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }
        
        button {
            background-color: #4b6cb7;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 0 10px;
        }
        
        button:hover {
            background-color: #3a5795;
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .results {
            display: none;
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            margin-top: 30px;
        }
        
        .results-title {
            text-align: center;
            color: #4b6cb7;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .score {
            text-align: center;
            font-size: 1.5rem;
            margin: 20px 0;
            padding: 15px;
            background-color: #f8fbff;
            border-radius: 8px;
        }
        
        .correct-answer {
            color: #27ae60;
            font-weight: bold;
        }
        
        .wrong-answer {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .restart-btn {
            background-color: #27ae60;
        }
        
        .restart-btn:hover {
            background-color: #219653;
        }
        
        .shuffle-info {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .progress {
            height: 100%;
            background-color: #4b6cb7;
            width: 0%;
            transition: width 0.3s;
        }
        
        .progress-text {
            text-align: center;
            margin-bottom: 10px;
            font-weight: bold;
            color: #4b6cb7;
            position: sticky;
            top: 10px;
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 99;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            text-align: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stat-item {
            padding: 15px;
            border-radius: 8px;
            min-width: 150px;
            flex: 1;
        }
        
        .stat-correct {
            background-color: #e7f7e7;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .stat-incorrect {
            background-color: #ffeaea;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .stat-remaining {
            background-color: #e3eeff;
            color: #004085;
            border: 1px solid #b8daff;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }
        
        .stat-label {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .test-info {
            text-align: center;
            background-color: #e3eeff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .question-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }
        
        .nav-btn {
            background-color: #6c757d;
            padding: 8px 20px;
            font-size: 0.9rem;
        }
        
        .nav-btn:hover {
            background-color: #5a6268;
        }
        
        .result-item {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            background-color: #f8f9fa;
            border-left: 4px solid #4b6cb7;
        }
        
        .result-item.correct {
            border-left-color: #27ae60;
            background-color: #e7f7e7;
        }
        
        .result-item.incorrect {
            border-left-color: #e74c3c;
            background-color: #ffeaea;
        }
        
        .result-question {
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .result-answer {
            margin-bottom: 5px;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .test-container, .results {
                padding: 15px;
            }
            
            button {
                display: block;
                width: 100%;
                margin: 10px 0;
            }
            
            .stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .stat-item {
                min-width: auto;
            }
            
            .question-nav {
                flex-direction: column;
                gap: 10px;
            }
            
            .variant::after {
                content: "" !important;
            }
            
            .variant.correct::after,
            .variant.incorrect::after {
                content: "" !important;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Ақпараттық технологиялар тесті</h1>
        <p>149 сұрақ - Моментальды тексеру жүйесі</p>
    </header>
    
    <div class="test-info">
        Жауапты таңдаған сәтте оның дұрыс/қате екені көрсетіледі. Әр сұраққа бір рет жауап беруге болады.
    </div>
    
    <div class="stats">
        <div class="stat-item stat-correct">
            <span class="stat-number" id="correctCount">0</span>
            <span class="stat-label">Дұрыс жауаптар</span>
        </div>
        <div class="stat-item stat-incorrect">
            <span class="stat-number" id="incorrectCount">0</span>
            <span class="stat-label">Қате жауаптар</span>
        </div>
        <div class="stat-item stat-remaining">
            <span class="stat-number" id="remainingCount">149</span>
            <span class="stat-label">Жауап берілмеген</span>
        </div>
    </div>
    
    <div class="progress-text">Сұрақ: <span id="currentQuestion">1</span> / <span id="totalQuestions">149</span></div>
    <div class="progress-bar">
        <div class="progress" id="progressBar"></div>
    </div>
    
    <div class="shuffle-info" id="shuffleInfo">
        Сурақтар және жауаптар әр қайтадан бастауда кездейсоқ реттеледі.
    </div>
    
    <div class="test-container" id="testContainer">
        <!-- Вопросы будут сгенерированы JavaScript -->
    </div>
    
    <div class="controls">
        <button id="showResultsBtn" disabled>Тест нәтижесін көрсету</button>
        <button id="restartBtn">Тестті қайта бастау</button>
    </div>
    
    <div class="results" id="resultsContainer">
        <!-- Результаты будут показаны здесь -->
    </div>

    <script>
        // Вопросы в формате текста
        const questionsText = `... (тут должен быть весь текст с вопросами из предыдущего сообщения) ...`;

        // Парсинг вопросов
        function parseQuestionsFromText(text) {
            const lines = text.split('\n');
            const questions = [];
            let currentQuestion = null;
            
            for (let line of lines) {
                line = line.trim();
                if (!line) continue;
                
                if (line.startsWith('<question>')) {
                    if (currentQuestion) {
                        questions.push(currentQuestion);
                    }
                    currentQuestion = {
                        question: line.replace('<question>', '').trim(),
                        variants: [],
                        correctAnswer: 0 // По умолчанию правильный ответ - первый вариант
                    };
                } else if (line.startsWith('<variant>')) {
                    if (currentQuestion) {
                        currentQuestion.variants.push(line.replace('<variant>', '').trim());
                    }
                }
            }
            
            if (currentQuestion) {
                questions.push(currentQuestion);
            }
            
            return questions;
        }

        // Парсим вопросы
        const allQuestions = parseQuestionsFromText(questionsText);
        
        // Глобальные переменные
        let currentTestData = [];
        let userAnswers = [];
        let isTestCompleted = false;
        let correctAnswersCount = 0;
        let incorrectAnswersCount = 0;
        let currentQuestionIndex = 0;

        // Функция для перемешивания массива
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Функция для перемешивания вариантов ответов в каждом вопросе
        function shuffleTestVariants() {
            currentTestData = allQuestions.map(question => {
                const correctVariant = question.variants[question.correctAnswer];
                const shuffledVariants = shuffleArray([...question.variants]);
                const newCorrectIndex = shuffledVariants.indexOf(correctVariant);
                
                return {
                    question: question.question,
                    variants: shuffledVariants,
                    correctAnswer: newCorrectIndex,
                    originalCorrectAnswer: question.correctAnswer
                };
            });
            
            // Перемешиваем сами вопросы
            currentTestData = shuffleArray(currentTestData);
        }

        // Инициализация теста
        function initTest() {
            shuffleTestVariants();
            userAnswers = new Array(currentTestData.length).fill(undefined);
            isTestCompleted = false;
            correctAnswersCount = 0;
            incorrectAnswersCount = 0;
            currentQuestionIndex = 0;
            
            updateStats();
            updateProgress();
            renderCurrentQuestion();
            document.getElementById('showResultsBtn').disabled = true;
            document.getElementById('resultsContainer').style.display = 'none';
        }

        // Функция для отображения текущего вопроса
        function renderCurrentQuestion() {
            const testContainer = document.getElementById('testContainer');
            const question = currentTestData[currentQuestionIndex];
            
            testContainer.innerHTML = `
                <div class="question">
                    <div class="question-number">Сұрақ ${currentQuestionIndex + 1}:</div>
                    <div class="question-text">${question.question}</div>
                    <div class="variants" id="variants-container">
                        ${question.variants.map((variant, variantIndex) => {
                            const isSelected = userAnswers[currentQuestionIndex] === variantIndex;
                            const isCorrectAnswer = variantIndex === question.correctAnswer;
                            const isUserAnswer = userAnswers[currentQuestionIndex] === variantIndex;
                            const isAnswered = userAnswers[currentQuestionIndex] !== undefined;
                            
                            let className = 'variant';
                            if (isSelected) className += ' selected';
                            if (isAnswered && isCorrectAnswer) className += ' correct';
                            if (isAnswered && isUserAnswer && !isCorrectAnswer) className += ' incorrect';
                            if (isAnswered) className += ' disabled';
                            
                            return `
                                <div class="${className}" 
                                     data-question-index="${currentQuestionIndex}" 
                                     data-variant-index="${variantIndex}">
                                    ${variantIndex + 1}. ${variant}
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
                <div class="question-nav">
                    <button class="nav-btn" id="prevBtn" ${currentQuestionIndex === 0 ? 'disabled' : ''}>← Алдыңғы сұрақ</button>
                    <button class="nav-btn" id="nextBtn" ${currentQuestionIndex === currentTestData.length - 1 ? 'disabled' : ''}>Келесі сұрақ →</button>
                </div>
            `;
            
            // Добавляем обработчики событий для вариантов ответов
            document.querySelectorAll('.variant:not(.disabled)').forEach(variant => {
                variant.addEventListener('click', function() {
                    const questionIndex = parseInt(this.getAttribute('data-question-index'));
                    const variantIndex = parseInt(this.getAttribute('data-variant-index'));
                    
                    // Если уже отвечали на этот вопрос, ничего не делаем
                    if (userAnswers[questionIndex] !== undefined) return;
                    
                    // Сохраняем ответ пользователя
                    userAnswers[questionIndex] = variantIndex;
                    
                    // Проверяем правильность ответа
                    const isCorrect = variantIndex === currentTestData[questionIndex].correctAnswer;
                    
                    // Обновляем счетчики
                    if (isCorrect) {
                        correctAnswersCount++;
                    } else {
                        incorrectAnswersCount++;
                    }
                    
                    // Обновляем статистику
                    updateStats();
                    
                    // Перерисовываем текущий вопрос для отображения правильных ответов
                    renderCurrentQuestion();
                    
                    // Обновляем прогресс
                    updateProgress();
                    
                    // Проверяем, все ли вопросы отвечены
                    checkAllAnswers();
                });
            });
            
            // Обработчики для кнопок навигации
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (prevBtn) {
                prevBtn.addEventListener('click', function() {
                    if (currentQuestionIndex > 0) {
                        currentQuestionIndex--;
                        renderCurrentQuestion();
                        updateProgress();
                    }
                });
            }
            
            if (nextBtn) {
                nextBtn.addEventListener('click', function() {
                    if (currentQuestionIndex < currentTestData.length - 1) {
                        currentQuestionIndex++;
                        renderCurrentQuestion();
                        updateProgress();
                    }
                });
            }
        }

        // Обновление статистики
        function updateStats() {
            const totalQuestions = currentTestData.length;
            const answeredCount = userAnswers.filter(answer => answer !== undefined).length;
            const remainingCount = totalQuestions - answeredCount;
            
            document.getElementById('correctCount').textContent = correctAnswersCount;
            document.getElementById('incorrectCount').textContent = incorrectAnswersCount;
            document.getElementById('remainingCount').textContent = remainingCount;
        }

        // Обновление прогресса
        function updateProgress() {
            const totalQuestions = currentTestData.length;
            const progress = ((currentQuestionIndex + 1) / totalQuestions) * 100;
            
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = totalQuestions;
        }

        // Проверка, все ли вопросы отвечены
        function checkAllAnswers() {
            const allAnswered = userAnswers.every(answer => answer !== undefined);
            
            if (allAnswered) {
                isTestCompleted = true;
                document.getElementById('showResultsBtn').disabled = false;
            }
        }

        // Показ результатов
        function showResults() {
            const resultsContainer = document.getElementById('resultsContainer');
            const totalQuestions = currentTestData.length;
            const scorePercentage = (correctAnswersCount / totalQuestions) * 100;
            
            let resultsHTML = `
                <div class="results-title">Тест нәтижелері</div>
                <div class="score">
                    Сіз ${totalQuestions} сұрақтың ${correctAnswersCount} дұрыс жауап бердіңіз.<br>
                    Нәтиже: <span class="${scorePercentage >= 70 ? 'correct-answer' : 'wrong-answer'}">${scorePercentage.toFixed(1)}%</span>
                </div>
                <div class="score">
                    Дұрыс жауаптар: <span class="correct-answer">${correctAnswersCount}</span><br>
                    Қате жауаптар: <span class="wrong-answer">${incorrectAnswersCount}</span>
                </div>
                <hr>
                <h3>Жекелеген сұрақтарға жауаптарыңыз:</h3>
            `;
            
            // Добавляем детали по каждому вопросу
            currentTestData.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.correctAnswer;
                const userAnswerText = userAnswer !== undefined ? 
                    `${userAnswer + 1}. ${question.variants[userAnswer]}` : 
                    "Жауап берілмеген";
                const correctAnswerText = `${question.correctAnswer + 1}. ${question.variants[question.correctAnswer]}`;
                
                resultsHTML += `
                    <div class="result-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <div class="result-question">Сұрақ ${index + 1}: ${question.question}</div>
                        <div class="result-answer">Сіздің жауабыңыз: ${userAnswerText}</div>
                        <div class="result-answer">Дұрыс жауап: ${correctAnswerText}</div>
                        ${!isCorrect ? `<div class="result-answer" style="color: #e74c3c;">Қате!</div>` : ''}
                    </div>
                `;
            });
            
            // Кнопка для возврата к тесту
            resultsHTML += `
                <div style="text-align: center; margin-top: 30px;">
                    <button onclick="document.getElementById('resultsContainer').style.display = 'none';">Нәтижелерді жасыру</button>
                </div>
            `;
            
            resultsContainer.innerHTML = resultsHTML;
            resultsContainer.style.display = 'block';
        }

        // Перезапуск теста
        function restartTest() {
            if (confirm("Тестті қайта бастағыңыз келе ме? Барлық жауаптар жойылады.")) {
                initTest();
            }
        }

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Устанавливаем обработчики для кнопок
            document.getElementById('showResultsBtn').addEventListener('click', showResults);
            document.getElementById('restartBtn').addEventListener('click', restartTest);
            
            // Инициализируем тест
            initTest();
        });
    </script>
</body>
</html>
